---
layout: post
title: GLM 广义线性模型
date: 2023-02-27
categories: 技术
tags: GLM 机器学习基础
---

GLM(Generalized Linear Model), 广义线性模型，是从普通线性模型(ordinary linear model)
引申出来的。它是一种概念，定义的是一类模型，线性回归、逻辑回归和泊松回归，都属于广义线性模型。

> 在这里，线性模型(linear model)和线性回归(linear regression)是同义、等价的。
因为根据维基百科 [Linear model][_lm], 在统计学的回归模型语境下，二者是 synonymous 的。
本文里，为了对应，当我们说到广义线性模型时，我们相应地使用（一般）线性模型这个词；
而在说到具体回归模型时，我们使用线性回归这个术语。

## 普通线性模型

普通线性模型的表达式为： 

$$
\newcommand{\bs}{\boldsymbol}
y = {\bs{\beta}}^T [\bs{x};1] + \epsilon
$$

其中 
- $y$ 是因变量 $Y$ 的一个取值，机器学习里其一般是 scalar 的（即非多元）
- $\bs{x}$ 是自变量 $X$ 的一个观测（取值）， $[\bs{x};1] = \{x_1, x_2, \cdots, x_n, 1\}$ 是齐次向量
- $\bs{\beta}^T = \{\beta_1, \beta_2, \cdots, \beta_n, \beta_0\}$ 表示对 $[\bs{x};1]$ 各维度的线性组合（含 bias $\beta_0$），是待求解参数
- $\epsilon$ 是噪声项，表示白噪声过程，服从 0 均值、同方差的正态分布。

> 一定要注意这里的噪声项！它必须要有，不然  
1\. 没法解释为何观测的 $y$ 和预测的值 $\hat{y}$ 有差异;  
2\. 没有此项，右边乘出来就是一个确定值，没法与左边的随机变量相等。

> 关注本文的大小写(如 $Y$/$y$ 等)符号：  
目前不是很规范，也不是很清楚。目前假定大写的字母表示整个分布，或者数据集全部构成的列表（或矩阵），
而小写的字母则表示单个观测/样本。

线性模型对各变量的要求和设置如下：

1. 因变量 $Y$ 属于正态分布！
  
   如常用线性回归来建模的“房价预测”问题，其因变量 $Y = \textit{某区域房价}$ 就属于正态分布。

   需要注意，这里 *$Y$ 的分布*，是指 $Y$ 作为单个随机变量自身的分布， 与 $X$ 无关。

2. 自变量观测 $\bs{x}$ 和未知参数 $\bs{\beta}$ 具有非随机性：即 $\bs{x}$ 是确定的（毕竟数据已经确定了），
$\bs{\beta}$ 虽然未知，但也是确定的。
3. 研究对象是给定 $X$ 下 $Y$ 的均值（期望）$E[Y \mid X]$. 用[维基百科][_glm]里的话，即 *the expected value of $Y$ conditional on $X$*

   再次说明，因为噪声 $\epsilon$ 的存在，在确定了 $\bs{x}$ 和 $\bs{\beta}$ 后，$y$ 依然是一个分布而非确定值！
   通过求解期望，就将 $\epsilon$ 去掉了，因为其期望为 0.

> 以前学线性回归，根本没有考虑过 $Y$ 应该满足的分布， 单纯认为 $Y$ 是连续值即可。也没有想到我们求解的是 $E[Y \mid X]$. 

由上，可知普通线性模型只能处理 $Y$ 属于正态分布的场景，
能不能扩展一下上述定义，让自变量的线性组合，可以表达更多分布类型的因变量呢？ 可以，这便引出 GLM 了。

## 广义线性模型

1972 年，John Nelder 和 Robert Wedderburn 在 *Journal of the Royal Statistical Society, Series A* 发表文章 *Generalized Linear Model*, 将不同分布的因变量 $Y$ 与自变量 $X$ 的线性组合通过 `link-function` 联系起来，
从而实现了线性模型的泛化。

GLM 有如下要求和设置：

1. $Y$ 服从某个分布，这个分布必须来自指数分布族(expotential family).
   指数分布族是一大类概率分布，正态分布、二项分布、泊松分布和伽马分布等都在其中。
2. 存在线性组合 $\eta = \bs{X}\bs{\beta}$, 其中 $\bs{\beta}$ 未知但是确定的； $\bs{X}$ 同样确定

   这里似乎没有了误差项 $\epsilon$? 毕竟定义的是 $\eta$, 它可能就是被定义为确定值吧。

   $\eta$ 也被称为 linear predictor.

3. 研究对象同样是 $E[Y \mid X] = \mu$, $\mu$ 是期望值.

4. 额外定义一个链接函数(`link-function`) $g$，使得 $E[Y \mid X] = g^{-1}(\bs{X}\bs{beta})$, 也即 $\mu = g^{-1}(\eta)$.
   
   注意，链接函数是取反函数，再作用到线性组合上的。也就是说，链接函数是直接作用到 $\mu$ 上的。
   但所有的资料都是上面的写法，不知道为为啥。

由上，就是 GLM 的定义了。其实还是很简单的，只是引入了一些术语： 

1. 指数分布族：


参考： https://www.jianshu.com/p/9c61629a1e7d
https://zhuanlan.zhihu.com/p/64157078

https://zhuanlan.zhihu.com/p/420499972 更详细

https://cosx.org/2011/01/how-does-glm-generalize-lm-assumption/ 这个统计之都的，评论里有yihui的，很有启发！

https://zhuanlan.zhihu.com/p/124757082 这个文章比较完善，看起来也参考了统计之都的文章。

伯努利和二项分布： https://zhuanlan.zhihu.com/p/49267988

[^1]: 参考[维基百科-Generalized linear model][_glm]: Generalized linear models were formulated by John Nelder and Robert Wedderburn as a way of unifying various other statistical models, including linear regression, logistic regression and Poisson regression.

[_glm]: https://en.wikipedia.org/wiki/Generalized_linear_model "Generalized linear model"

[_lm]: https://en.wikipedia.org/wiki/Linear_model "Linear model"