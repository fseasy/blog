---
layout: mathpage
title: C++Primer读书笔记4
date: 2016-01-15
categories: 技术 笔记 
tags: C++ 笔记 C++Primer
onewords:  第七章-类。
---
> C++ Primer（第五版）第七章内容——类。

0. 定义类的目的

    数据抽象与封装。

    对外指提供接口，隐藏实现。或者说接口与实现分离。

1. 类成员函数声明与定义

    类的成员函数都要声明在类内部，但定义可以外部。

    定义在内部的成员函数默认是内联(inline)的(隐式inline)。

2. 类成员函数的隐式this指针

    在成员函数内部访问类成员或函数，都隐式的通过`this`指针访问。

        string Info::get_info()
        {
            return info ; 
        }
        
        Info inf ;
        cout << inf.get_info() ;
        
        ==>

        string Info::get_info(Info * const this )
        {
            return this->info
        }
        Info inf ;
        cout << get_info(&inf) ;

    如上，就大概是编译器实际实现类成员函数调用、访问的过程。这个通过Python中类成员函数定义就比较清晰。

        Class Info(object) :
            def get_info(self) :
                return self.info


    需要注意的是其中的`const`，根据书上的描述，`this`的值是不能被改变的。所以我想它传递的应该是一个底层const的指针。

    > 因为this变量被隐式定义，所以我们不能再定义名为this的变量。也不能修改this变量的值。


3. 定义const成员函数

    如果成员函数不修改成员变量值，那么通过在函数形参列表后加入const关键字来实现该逻辑。

        string Info::get_info() const {...}

    实际上是通过给隐式的`this`指针加上顶层`const`。

        string Info::get_info(const Info *const this) {...}

    如果类要支持常量定义，那么定义const的函数是必须的。因为如果定义类的const实例，而函数都是非const的，由于非const实例不能绑定到顶层const指针上，所以成员函数不可用。

4. 类作用域

    类本身就是一个作用域。

    在外部定义类的成员函数时，需要使用作用域运算符`::`。
        string Info::get_info()
        {
            return info .
        }

5. 类成员变量、成员函数的定义顺序与调用顺序无关

    如果函数A定义在函数B的后面，但是在函数B也可以直接调用函数A。

    因为编译器分两步处理类：

    首先编译成员的声明。

    然后再编译函数体（如果有的话）。

6. 返回调用对象本身的引用

    使用`*this`来返回调用的对象本身。

        Info& Info::add(Info & b) 
        {
            info += b.info ;
            return *this ;
        } 
    
    注意函数返回类型的引用符号——返回的是调用对象的引用，即左值。




