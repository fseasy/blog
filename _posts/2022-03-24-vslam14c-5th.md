---
layout: post
title: 视觉SLAM十四讲-第五讲《相机与图像》学习
date: 2022-03-24
categories: 技术 
tags: 视觉SLAM十四讲 SLAM 径向畸变 相机成像
---
> 本节讲了相机模型（针孔、畸变、双目、RGB-D）、图像在计算机中的表示及一些基础操作。

## 1. 术语表

| 中文名称 | 英文名称                                              |
| :------- | :---------------------------------------------------- |
| 针孔相机 | pinhole camera                                        |
| 齐次坐标 | homogeneous coordinates                               |
| 内参     | intrinsics                                            |
| 外参     | extrinsics                                            |
| 光轴     | optical axis                                          |
| 畸变     | distortion/distort                                    |
| 径向畸变 | radial distortion                                     |
| 切向畸变 | tangential distortion                                 |
| 桶形畸变 | barrel distortion (i.e. negative radial distortion)   |
| 枕形畸变 | pincusion distortion (i.e. positive radial distotion) |
| 畸变校正 | undistort                                             |

opencv的资源：
1. python版校准： https://docs.opencv.org/3.4.17/dc/dbb/tutorial_py_calibration.html
3. 自带的棋盘照片： https://github.com/opencv/opencv/blob/4.x/samples/data/left07.jpg (left01-14都是) 

## 2. 相机模型

相机模型，描述了一个真实世界的物体变成图像（像素）的过程。一般地，这涉及到3个坐标系上的转换：

$$
    世界坐标系(P_w) \rightarrow 相机坐标系(P_c) \rightarrow 像素坐标系(p)
$$

其中相机坐标系，一般以相机光心为坐标原点，光心所在平面为x、y轴所在平面，z轴垂直此平面指向物体方向。 
书中介绍此坐标系下有几个关键的平面： 

- 真实成像平面：焦平面，即胶片/CCD所在的平面。Z轴坐标为负（物体经过光心成倒立像，物体在Z轴正半轴，则成像平面在负半轴）。

- 对称成像平面：真实成像平面关于光心的对称平面。Z轴坐标为正。这是把底片成像翻转为我们正常看到的物体方向。
  可以认为这是相机的默认操作——且因为与物体在同一个半轴，计算更加方便，故实际计算时，一般直接用此平面。

- 归一化成像平面： 物体世界坐标 $P_w$ 转换为相机坐标 $P_c$后，还保留有 Z 轴信息。
然而 $P_c$ 最终投影到底片（成像平面）时，没有了深度（Z轴）信息。为了在 $P_c \rightarrow p$ 过程中计算方便，
首先将 $P_c$ 按Z轴值缩放，即 $P_c(X, Y, Z) \rightarrow P_{c}^{'}(X/Z, Y/Z, 1)$. 
此归一化后的点，所在平面Z轴坐标为1，称其为归一化成像平面。

总结下来，对称成像平面、归一化成像平面，都是为了计算方便而人为定义的平面。

### 2.1 针孔相机模型

知道了整个建模的框架后，我们要实际看下计算逻辑。相机模型中，最简单/经典的就是针孔相机模型，也即义务教育阶段就学习过的
小孔成像。

在 [opencv-calibration][opencv_cali] 中有一张[针孔相机模型图][pinhole_model]，非常漂亮地解释了整个过程。
这里我照着拿PPT重画了一下（纸上也画了下），强化理解记忆：




### 2.2 （镜头）畸变


https://en.wikipedia.org/wiki/Distortion_(optics)#cite_note-brown-4

https://en.wikipedia.org/wiki/Optical_axis

Brown-Conrady 畸变模型

有一张解释径向畸变和切向畸变的图，
[12](https://xhy3054.github.io/camera-calibration-undistort/)
https://xhy3054.github.io/camera-calibration-undistort/

#### 附： 畸变原理及其他

畸变是因为镜头本身带来的。spherical aberrations.

https://www.bilibili.com/video/av97893301/


除了市面常见的基于镜头（Lens）的相机，还真的有针孔相机。
从[知乎问题-为什么相机普遍没有采用小孔成像原理？它的缺陷在哪儿？][zh1]
里的回答里，可以看到 [Coded Aperture Imaging][coded_ai] 这篇有意思的文章。
里面提到针孔相机的优势： 

1. 无限景深 (infinite depth of field)
2. 无色差 (don't suffer from chromatic aberration) 
3. 可为高能光源成像 (form images from X-ray/Gamma-ray)

但它显然的劣势就是透光亮小，无法应用到消费市场（想象一个固定小光圈的镜头，显然没人会买的），但在特定领域仍有价值。

[zh1]: https://www.zhihu.com/question/26800674 "为什么相机普遍没有采用小孔成像原理？它的缺陷在哪儿？"
[coded_ai]: http://www.paulcarlisle.net/old/codedaperture.html "Coded Aperture Imaging"
[opencv_cali]: https://docs.opencv.org/3.4.17/d9/d0c/group__calib3d.html "Camera Calibration and 3D Reconstruction"
[pinhole_model]: https://docs.opencv.org/3.4.17/pinhole_camera_model.png